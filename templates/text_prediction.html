{% extends "base.html" %}

{% block title %}Text Analysis - MBTI Personality Predictor{% endblock %}

{% block extra_css %}
<style>
    .text-intro {
        margin-bottom: 20px;
        color: #000;
        font-family: var(--font-mono);
        text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);
    }
    .text-intro-label {
        display: block;
        margin-bottom: 10px;
        font-weight: 400;
        color: #000;
        font-family: var(--font-display);
        font-size: 1.1rem;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        text-shadow: 
            0 0 6px var(--y2k-neon-blue),
            1px 1px 0 rgba(0, 0, 0, 0.8);
    }
    .text-input-area {
        width: 100%;
        padding: 15px;
        border: 3px inset rgba(192, 192, 192, 0.8);
        border-radius: 4px;
        font-size: 16px;
        font-family: var(--font-mono);
        resize: vertical;
        background: 
            linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%),
            repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0, 217, 255, 0.05) 2px, rgba(0, 217, 255, 0.05) 4px);
        color: var(--y2k-neon-green);
        box-shadow: 
            inset 0 2px 8px rgba(0, 0, 0, 0.6),
            0 0 15px rgba(0, 217, 255, 0.3) inset;
        text-shadow: 0 0 4px var(--y2k-neon-green);
    }
    .text-input-area::placeholder {
        color: rgba(0, 217, 255, 0.5);
        text-shadow: 0 0 4px rgba(0, 217, 255, 0.3);
    }
    .text-tip {
        margin-top: 5px;
        color: #000;
        font-size: 0.85rem;
        font-family: var(--font-mono);
        text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);
    }
    .text-result-card {
        background: 
            linear-gradient(135deg, rgba(192, 192, 192, 0.95) 0%, rgba(74, 144, 226, 0.9) 50%, rgba(192, 192, 192, 0.95) 100%),
            repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(255, 255, 255, 0.1) 8px, rgba(255, 255, 255, 0.1) 16px);
        color: #000;
        border: 4px solid;
        border-image: linear-gradient(135deg, var(--y2k-neon-blue), var(--y2k-neon-purple), var(--y2k-neon-green)) 1;
        box-shadow:
            0 0 20px rgba(0, 217, 255, 0.6),
            0 0 15px rgba(184, 77, 255, 0.4),
            0 8px 24px rgba(0, 0, 0, 0.6),
            inset 0 1px 0 rgba(255, 255, 255, 0.7),
            inset 0 -1px 0 rgba(0, 0, 0, 0.3);
        transform: rotate(-0.3deg);
    }
    .text-result-title {
        color: #000;
        margin-bottom: 20px;
    }
    .text-type-badge {
        font-family: var(--font-display);
        font-size: 3rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        margin-bottom: 10px;
        text-shadow: 
            0 0 12px var(--y2k-neon-blue),
            0 0 20px var(--y2k-neon-purple),
            3px 3px 0 rgba(0, 0, 0, 0.8),
            -1px -1px 0 rgba(255, 255, 255, 0.6);
        filter: drop-shadow(0 0 10px rgba(0, 217, 255, 0.9));
        color: #000;
    }
    .text-type-sub {
        font-size: 1rem;
        opacity: 0.95;
        font-family: var(--font-mono);
        text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);
        color: #000;
    }
    .dimension-chip {
        background: 
            linear-gradient(180deg, rgba(255, 255, 255, 0.9) 0%, rgba(192, 192, 192, 0.9) 100%),
            repeating-linear-gradient(90deg, transparent, transparent 4px, rgba(0, 0, 0, 0.03) 4px, rgba(0, 0, 0, 0.03) 5px);
        border-radius: 6px;
        padding: 18px;
        text-align: center;
        border: 3px outset rgba(192, 192, 192, 0.8);
        box-shadow: 
            0 0 10px rgba(0, 217, 255, 0.4),
            0 4px 10px rgba(0, 0, 0, 0.4),
            inset 0 1px 0 rgba(255, 255, 255, 0.7);
    }
    .dimension-chip-label {
        font-size: 0.9rem;
        margin-bottom: 6px;
        font-family: var(--font-display);
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #000;
        text-shadow: 
            0 0 6px var(--y2k-neon-blue),
            1px 1px 0 rgba(0, 0, 0, 0.8);
    }
    .dimension-chip-letter {
        font-size: 2rem;
        margin-bottom: 4px;
        font-family: var(--font-display);
        color: #000;
        text-shadow: 
            0 0 10px var(--y2k-neon-purple),
            2px 2px 0 rgba(0, 0, 0, 0.8);
        filter: drop-shadow(0 0 6px rgba(184, 77, 255, 0.8));
    }
    .dimension-chip-conf {
        font-size: 0.85rem;
        font-family: var(--font-mono);
        color: #000;
        text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <h2>üìù Text-Based Personality Prediction</h2>
    <p class="text-intro">
        Enter a text description about yourself, your preferences, or how you approach situations. 
        Our machine learning models will analyze your writing style to predict your MBTI personality type.
    </p>
    
    {% if error %}
    <div class="alert alert-error">
        <strong>Error:</strong> {{ error }}
    </div>
    {% endif %}
    
    <form method="POST" action="{{ url_for('text_prediction') }}">
        <div style="margin-bottom: 20px;">
            <label for="text_input" class="text-intro-label">
                Your Text Description:
            </label>
            <textarea 
                id="text_input" 
                name="text_input" 
                rows="8" 
                class="text-input-area"
                placeholder="Example: I enjoy breaking down complex problems and finding logical solutions. I prefer working independently and value deep, meaningful conversations over small talk..."
                required>{{ input_text if input_text else '' }}</textarea>
            <p class="text-tip">
                üí° Tip: Write at least 50-100 words for better accuracy.
            </p>
        </div>
        
        <button type="submit" class="btn">üîÆ Predict Personality</button>
    </form>
</div>

{% if result %}
<div class="card text-result-card">
    <h2 class="text-result-title">üéØ Prediction Results</h2>
    
    <div style="text-align: center; padding: 30px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 30px;">
        <div class="text-type-badge">{{ result.personality_type }}</div>
        {% if mbti_info %}
        <div class="text-type-sub">{{ mbti_info.title }} ¬∑ {{ result.description }}</div>
        {% else %}
        <div class="text-type-sub">{{ result.description }}</div>
        {% endif %}
    </div>
    
    <h3 style="margin-bottom: 15px; font-family: var(--font-display); letter-spacing: 0.08em; text-transform: uppercase; font-size: 1rem; color: #000; text-shadow: 0 0 6px var(--y2k-neon-blue), 2px 2px 0 rgba(0, 0, 0, 0.8);">
        üìä Dimension Analysis
    </h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        {% for dimension, pred in result.dimensions.items() %}
        {% if dimension == 'E/I' %}
            {% set letter = 'I' if pred.prediction == 1 else 'E' %}
        {% elif dimension == 'S/N' %}
            {% set letter = 'S' if pred.prediction == 0 else 'N' %}
        {% elif dimension == 'T/F' %}
            {% set letter = 'T' if pred.prediction == 0 else 'F' %}
        {% elif dimension == 'J/P' %}
            {% set letter = 'J' if pred.prediction == 1 else 'P' %}
        {% else %}
            {% set letter = 'X' %}
        {% endif %}
        
        <div class="dimension-chip">
            <div class="dimension-chip-label">{{ dimension }}</div>
            <div class="dimension-chip-letter">{{ letter }}</div>
            <div class="dimension-chip-conf">{{ "%.1f"|format(pred.probability * 100) }}% confidence</div>
        </div>
        {% endfor %}
    </div>
</div>

{% if mbti_info %}
<div class="card">
    <h2>üìñ Detailed Personality Description</h2>
    
    <div style="margin-bottom: 25px;">
        <h3 style="color: #000; margin-bottom: 15px; font-size: 1.3rem; font-family: var(--font-display); letter-spacing: 0.05em; text-transform: uppercase; text-shadow: 0 0 8px var(--y2k-neon-blue), 2px 2px 0 rgba(0, 0, 0, 0.8);">
            {{ result.personality_type }} ‚Äì {{ mbti_info.title }}
        </h3>
        <p style="color: #000; line-height: 1.8; font-size: 1rem; margin-bottom: 25px; font-family: var(--font-mono); text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);">
            {{ mbti_info.summary }}
        </p>
        
        {% if mbti_info.behaviors and mbti_info.behaviors|length > 0 %}
        <h3 style="color: #000; margin-bottom: 15px; font-size: 1.1rem; font-family: var(--font-display); letter-spacing: 0.05em; text-transform: uppercase; text-shadow: 0 0 6px var(--y2k-neon-purple), 2px 2px 0 rgba(0, 0, 0, 0.8);">Key Behaviors & Characteristics</h3>
        <div style="display: grid; gap: 20px;">
            {% for behavior in mbti_info.behaviors %}
            <div style="padding: 18px; background: linear-gradient(180deg, rgba(255, 255, 255, 0.9) 0%, rgba(192, 192, 192, 0.9) 100%); border-radius: 6px; border: 3px outset rgba(192, 192, 192, 0.8); box-shadow: 0 0 10px rgba(0, 217, 255, 0.3), inset 0 2px 4px rgba(0, 0, 0, 0.2);">
                <h4 style="color: #000; margin-bottom: 10px; font-size: 1.1rem; font-weight: 400; font-family: var(--font-display); letter-spacing: 0.05em; text-transform: uppercase; text-shadow: 0 0 6px var(--y2k-neon-blue), 1px 1px 0 rgba(0, 0, 0, 0.8);">
                    {{ behavior.title }}
                </h4>
                <p style="color: #000; line-height: 1.7; margin: 0; font-family: var(--font-mono); text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.6);">
                    {{ behavior.description }}
                </p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endif %}
{% endif %}
{% endblock %}
