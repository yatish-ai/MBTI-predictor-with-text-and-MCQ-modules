{% extends "base.html" %}

{% block title %}MCQ Results - MBTI Personality Predictor{% endblock %}

{% block extra_css %}
<style>
    .result-header {
        text-align: center;
        padding: 40px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        margin-bottom: 30px;
    }
    
    .result-header h1 {
        font-size: 4em;
        margin-bottom: 15px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .result-header p {
        font-size: 1.3em;
        opacity: 0.95;
    }
    
    .dimension-result {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        padding: 25px;
        margin-bottom: 20px;
        transition: transform 0.2s;
    }
    
    .dimension-result:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .dimension-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }
    
    .dimension-name {
        font-size: 1.3em;
        font-weight: 600;
        color: #667eea;
    }
    
    .trait-badge {
        font-size: 2em;
        font-weight: bold;
        padding: 10px 20px;
        border-radius: 8px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
    }
    
    .score-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }
    
    .score-item {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
    }
    
    .score-item label {
        display: block;
        font-size: 0.9em;
        color: #6c757d;
        margin-bottom: 5px;
    }
    
    .score-item value {
        display: block;
        font-size: 1.3em;
        font-weight: 600;
        color: #333;
    }
    
    .confidence-bar {
        background: #e9ecef;
        height: 25px;
        border-radius: 12px;
        overflow: hidden;
        margin-top: 10px;
        position: relative;
    }
    
    .confidence-fill {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.85em;
        transition: width 0.5s;
    }
    
    .actions {
        text-align: center;
        margin-top: 40px;
        padding-top: 30px;
        border-top: 2px solid #e9ecef;
    }
    
    .actions a {
        margin: 0 10px;
    }
</style>
{% endblock %}

{% block content %}
<div class="result-header">
    <h1>{{ result.personality_type }}{% if mbti_info %} ‚Äì {{ mbti_info.title }}{% endif %}</h1>
    <p>{{ result.description }}</p>
</div>

{% if mbti_info %}
<div class="card">
    <h2>üìñ Detailed Personality Description</h2>
    
    <div style="margin-bottom: 25px;">
        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.2em;">
            {{ result.personality_type }} ‚Äì {{ mbti_info.title }}
        </h3>
        <p style="color: #555; line-height: 1.8; font-size: 1.05em; margin-bottom: 25px;">
            {{ mbti_info.summary }}
        </p>
        
        {% if mbti_info.behaviors and mbti_info.behaviors|length > 0 %}
        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.1em;">Key Behaviors & Characteristics</h3>
        <div style="display: grid; gap: 20px;">
            {% for behavior in mbti_info.behaviors %}
            <div style="padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #667eea;">
                <h4 style="color: #667eea; margin-bottom: 10px; font-size: 1.05em; font-weight: 600;">
                    {{ behavior.title }}
                </h4>
                <p style="color: #555; line-height: 1.7; margin: 0;">
                    {{ behavior.description }}
                </p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endif %}

<div class="card">
    <h2>üìä Detailed Dimension Analysis</h2>
    <p style="margin-bottom: 25px; color: #555;">
        Below is a breakdown of your scores and confidence levels for each MBTI dimension.
    </p>
    
    {% for dimension, dim_result in result.dimensions.items() %}
    <div class="dimension-result">
        <div class="dimension-header">
            <span class="dimension-name">{{ dimension }} Dimension</span>
            <span class="trait-badge">{{ dim_result.trait }}</span>
        </div>
        
        <div class="score-info">
            <div class="score-item">
                <label>Raw Score</label>
                <value>{{ dim_result.score }}</value>
            </div>
            <div class="score-item">
                <label>Confidence</label>
                <value>{{ "%.1f"|format(dim_result.confidence * 100) }}%</value>
            </div>
        </div>
        
        <div class="confidence-bar">
            <div class="confidence-fill" style="width: {{ dim_result.confidence * 100 }}%;">
                {{ "%.1f"|format(dim_result.confidence * 100) }}%
            </div>
        </div>
        
        <p style="margin-top: 15px; color: #6c757d; font-size: 0.9em;">
            {% if dimension == 'EI' %}
                {% if dim_result.trait == 'E' %}
                    You show preferences for <strong>Extraversion</strong> - gaining energy from external interactions.
                {% else %}
                    You show preferences for <strong>Introversion</strong> - gaining energy from internal reflection.
                {% endif %}
            {% elif dimension == 'SN' %}
                {% if dim_result.trait == 'S' %}
                    You show preferences for <strong>Sensing</strong> - focusing on concrete facts and details.
                {% else %}
                    You show preferences for <strong>Intuition</strong> - focusing on patterns and possibilities.
                {% endif %}
            {% elif dimension == 'TF' %}
                {% if dim_result.trait == 'T' %}
                    You show preferences for <strong>Thinking</strong> - making decisions based on logic and objectivity.
                {% else %}
                    You show preferences for <strong>Feeling</strong> - making decisions based on values and harmony.
                {% endif %}
            {% elif dimension == 'JP' %}
                {% if dim_result.trait == 'J' %}
                    You show preferences for <strong>Judging</strong> - preferring structure and organization.
                {% else %}
                    You show preferences for <strong>Perceiving</strong> - preferring flexibility and adaptability.
                {% endif %}
            {% endif %}
        </p>
    </div>
    {% endfor %}
</div>

<div class="card">
    <h2>üìà Score Summary</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <div style="font-size: 0.9em; color: #6c757d; margin-bottom: 5px;">EI Score</div>
            <div style="font-size: 2em; font-weight: bold; color: #667eea;">{{ result.scores.EI_score }}</div>
        </div>
        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <div style="font-size: 0.9em; color: #6c757d; margin-bottom: 5px;">SN Score</div>
            <div style="font-size: 2em; font-weight: bold; color: #667eea;">{{ result.scores.SN_score }}</div>
        </div>
        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <div style="font-size: 0.9em; color: #6c757d; margin-bottom: 5px;">TF Score</div>
            <div style="font-size: 2em; font-weight: bold; color: #667eea;">{{ result.scores.TF_score }}</div>
        </div>
        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <div style="font-size: 0.9em; color: #6c757d; margin-bottom: 5px;">JP Score</div>
            <div style="font-size: 2em; font-weight: bold; color: #667eea;">{{ result.scores.JP_score }}</div>
        </div>
    </div>
    
    <div style="margin-top: 25px; padding: 20px; background: #e8f4fd; border-radius: 10px; border-left: 4px solid #667eea;">
        <h3 style="color: #667eea; margin-bottom: 10px;">How Scores Work</h3>
        <p style="color: #555; line-height: 1.8;">
            Each dimension score is calculated by summing the values of your selected options. 
            Positive scores indicate preference for the first trait (E, S, T, J), while negative scores 
            indicate preference for the second trait (I, N, F, P). Confidence is calculated as the 
            absolute value of your score divided by the total number of questions for that dimension.
        </p>
    </div>
</div>

<div class="actions">
    <a href="{{ url_for('mcq_prediction') }}" class="btn">üîÑ Retake Test</a>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">üè† Back to Home</a>
</div>
{% endblock %}
